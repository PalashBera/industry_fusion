<header class="main-header" id="header">
  <nav class="navbar navbar-expand-lg navbar-light" id="navbar">
    <button id="sidebar-toggler" class="sidebar-toggle">
      <span class="sr-only">Toggle navigation</span>
    </button>

    <span class="page-title"><%= yield(:page_title) %></span>

    <div class="navbar-right">
      <ul class="nav navbar-nav">
        <li class="custom-dropdown">
          <button class="notify-toggler custom-dropdown-toggler">
            <i class="mdi mdi-bell-outline icon"></i>
            <span class="badge badge-xs rounded-circle msg-count message-count-<%= current_user.id %>"><%= current_user.user_notifications.length %></span>
          </button>
          <div class="dropdown-notify">

            <header>
              <div class="nav nav-underline" id="nav-tab" role="tablist">
                <a class="nav-item nav-link msg-tab message-tab-<%= current_user.id %>" id="message-tab" data-toggle="tab" href="#message" role="tab" aria-controls="nav-profile" aria-selected="false">Msg(<%= current_user.user_notifications.length %>)</a>
                <%= link_to "Mark all as read", mark_all_read_path, class: "mt-4 badge badge-pill badge-primary mark-all-read mark-all-#{current_user}", remote: true unless current_user.notification_all_read? %>
              </div>
              <% binding.pry %>
              <div class="msg-body message-body-<%= current_user.id %> media-body">
                <% current_user.user_notifications.order_by_date.each do |notify| %>
                  <div class="tab-pane" id="message" role="tabpanel" aria-labelledby="message-tab">
                    <div class="media media-sm p-4 mb-0">
                      <div class="media-body">
                        <%= notify.message %>

                        <% unless notify.read %>
                          <%= link_to "Mark as read", mark_read_path(id: notify.id), class: "mt-4 badge badge-pill badge-primary mark-read", remote: true %>
                        <% end %>
                      </div>
                    </div>
                  </div>
                <% end %>
              </div>
            </header>
          </div>
        </li>

        <li class="dropdown user-menu">
          <button class="dropdown-toggle nav-link" data-toggle="dropdown">
            <span class="user-image rounded-circle user-initial"><%= current_user.initial %></span>
            <span class="d-none d-lg-inline-block"><%= current_user.full_name %></span>
          </button>

          <ul class="dropdown-menu dropdown-menu-right">
            <li>
              <%= link_to edit_user_registration_path, class: "dropdown-link-item" do %>
                <i class="mdi mdi-settings"></i>
                <span class="nav-text">Account Setting</span>
              <% end %>
            </li>

            <li class="dropdown-footer">
              <%= link_to destroy_user_session_path, method: :delete, class: "dropdown-link-item" do %>
                <i class="mdi mdi-logout"></i>
                <span class="nav-text">Log Out</span>
              <% end %>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>
</header>
